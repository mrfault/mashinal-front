(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{1145:function(e,t,n){"use strict";var o=n(1),r=(n(32),n(174)),l={props:{hideInput:Boolean,placeholder:String},data:function(){return{email:this.$store.state.auth.user.email||"",newEmail:"",code:"",changeEmailInit:!1,confirmEmailEdit:!1,confirmEmailEditInput:!1,confirmEmailCodeInput:!1}},validations:{newEmail:{required:r.required,email:r.email},code:{required:Object(r.requiredIf)((function(){return this.confirmEmailCodeInput})),numeric:r.numeric}},methods:{openModalToChangeEmail:function(){this.user.email||(this.$emit("open"),this.changeEmailInit?this.confirmEmailCodeInput=!0:(this.$v.$reset(),this.newEmail="",this.code="",this.user.email?this.confirmEmailEdit=!0:this.confirmEmailEditInput=!0))},emailEditOpen:function(){this.confirmEmailEdit=!1,this.confirmEmailEditInput=!0},getCodeForNewEmail:function(){var e=this;this.$v.$touch(),this.$v.$error||this.$axios.$post("/profile/change_email_request",{email:this.newEmail}).then((function(){e.confirmEmailEditInput=!1,e.$v.$reset(),e.confirmEmailCodeInput=!0,e.changeEmailInit=!0}))},checkCodeForNewEmail:function(){var e=this;this.$v.$touch(),this.$v.$error||this.$axios.$post("/profile/change_email",{email:this.newEmail,code:this.code}).then(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.confirmEmailCodeInput=!1,e.changeEmailInit=!1,e.$v.$reset(),e.email=e.newEmail,e.newEmail="",e.code="",t.next=8,e.$auth.fetchUser();case 8:e.$emit("success");case 9:case"end":return t.stop()}}),t)}))))}},watch:{newEmail:function(e){this.$nuxt.$emit("new-email-updated",e)}},mounted:function(){var e=this;this.$nuxt.$on("new-email-updated",(function(t){e.newEmail=t})),this.$nuxt.$on("open-modal-to-change-email",this.openModalToChangeEmail)},beforeDestroy:function(){this.$nuxt.$off(["new-email-updated","open-modal-to-change-email"])}},c=n(12),component=Object(c.a)(l,(function(){var e=this,t=e._self._c;return t("div",[e.hideInput?e._e():t("form-text-input",{key:"email",attrs:{readonly:"",autocomplete:"email",maxlength:255,placeholder:e.placeholder||e.$t("add_email"),mask:e.$maskEmail(),disabled:!!e.user.email},nativeOn:{click:function(t){return e.openModalToChangeEmail.apply(null,arguments)}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmEmailEdit,title:e.$t("want_to_change_your_email")},on:{close:function(t){e.confirmEmailEdit=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.emailEditOpen.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("p",[e._v(e._s(e.$t("new_email_will_need_to_be_confirmed")))])]),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("confirm"))+"\n      ")])])]),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmEmailEditInput,title:e.$t("enter_new_email")},on:{close:function(t){e.confirmEmailEditInput=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.getCodeForNewEmail.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("form-text-input",{key:"newEmail",attrs:{autocomplete:"email",maxlength:255,placeholder:e.$t("enter_new_email"),mask:e.$maskEmail(),invalid:e.$v.newEmail.$error},model:{value:e.newEmail,callback:function(t){e.newEmail=t},expression:"newEmail"}})],1),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("get_code"))+"\n      ")])])]),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmEmailCodeInput,title:e.$t("enter_the_code_from_mail")},on:{close:function(t){e.confirmEmailCodeInput=!1,e.changeEmailInit=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.checkCodeForNewEmail.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("form-text-input",{key:"code",attrs:{placeholder:e.$t("5_digit_code_in_mail"),mask:"99999",invalid:e.$v.code.$error},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("change_email"))+"\n      ")])])])],1)}),[],!1,null,null,null);t.a=component.exports},1201:function(e,t,n){"use strict";var o=n(1),r=(n(32),n(14),n(21),n(174)),l=n(277),c={props:{hideInput:Boolean,placeholder:String},data:function(){var e=this.$store.state.auth.user;return{phone:e.phone?"+"+e.phone:"",newPhone:"",code:"",changePhoneInit:!1,confirmPhoneEdit:!1,confirmPhoneEditInput:!1,confirmPhoneCodeInput:!1}},validations:{newPhone:{required:r.required,isPhoneNumber:l.a},code:{required:Object(r.requiredIf)((function(){return this.confirmPhoneCodeInput})),numeric:r.numeric}},methods:{openModalToChangePhone:function(){this.user.phone||(this.$emit("open"),this.changePhoneInit?this.confirmPhoneCodeInput=!0:(this.$v.$reset(),this.newPhone="",this.code="",this.user.phone?this.confirmPhoneEdit=!0:this.confirmPhoneEditInput=!0))},phoneEditOpen:function(){this.confirmPhoneEdit=!1,this.confirmPhoneEditInput=!0},getSmsForNewNumber:function(){var e=this;this.$v.$touch(),this.$v.$error||this.$axios.$post("/profile/change_phone_request",{phone:this.newPhone.replace(/[^0-9]+/g,"")}).then((function(){e.confirmPhoneEditInput=!1,e.$v.$reset(),e.confirmPhoneCodeInput=!0,e.changePhoneInit=!0}))},checkCodeForNewNumber:function(){var e=this;this.$v.$touch(),this.$v.$error||this.$axios.$post("/profile/change_phone",{phone:this.newPhone.replace(/[^0-9]+/g,""),code:this.code}).then(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.confirmPhoneCodeInput=!1,e.changePhoneInit=!1,e.$v.$reset(),e.phone=e.newPhone,e.newPhone="",e.code="",t.next=8,e.$auth.fetchUser();case 8:e.$emit("close");case 9:case"end":return t.stop()}}),t)}))))}},watch:{newPhone:function(e){this.$nuxt.$emit("new-phone-updated",e)}},mounted:function(){var e=this;this.$nuxt.$on("new-phone-updated",(function(t){e.newPhone=t})),this.$nuxt.$on("open-modal-to-change-phone",this.openModalToChangePhone)},beforeDestroy:function(){this.$nuxt.$off(["new-phone-updated","open-modal-to-change-phone"])}},m=n(12),component=Object(m.a)(c,(function(){var e=this,t=e._self._c;return t("div",[e.hideInput?e._e():t("form-text-input",{key:"phone",attrs:{readonly:"",autocomplete:"tel",placeholder:e.placeholder||e.$t("add_mobile_number"),mask:e.$maskPhone(),disabled:!!e.user.phone},nativeOn:{click:function(t){return e.openModalToChangePhone.apply(null,arguments)}},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmPhoneEdit,title:e.$t("want_to_change_your_phone_number")},on:{close:function(t){e.confirmPhoneEdit=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.phoneEditOpen.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("p",[e._v(e._s(e.$t("the_new_number_will_need_to_be_confirmed_by_sms")))])]),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("confirm"))+"\n      ")])])]),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmPhoneEditInput,title:e.$t("enter_a_new_mobile_number")},on:{close:function(t){e.confirmPhoneEditInput=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.getSmsForNewNumber.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("form-text-input",{key:"newPhone",attrs:{autocomplete:"tel",placeholder:e.$t("enter_a_new_mobile_number"),mask:e.$maskPhone(),invalid:e.$v.newPhone.$error},model:{value:e.newPhone,callback:function(t){e.newPhone=t},expression:"newPhone"}})],1),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("get_sms"))+"\n      ")])])]),e._v(" "),t("modal-popup",{attrs:{toggle:e.confirmPhoneEditInput,title:e.$t("enter_the_code_from_sms")},on:{close:function(t){e.confirmPhoneEditInput=!1,e.changePhoneInit=!1,e.$emit("close")}}},[t("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.checkCodeForNewNumber.apply(null,arguments)}}},[t("div",{staticClass:"mb-2 mb-lg-3"},[t("form-text-input",{key:"code",attrs:{placeholder:e.$t("5_digit_code_in_sms"),mask:"99999",invalid:e.$v.code.$error},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),t("button",{class:["btn btn--green full-width"],attrs:{type:"submit"}},[e._v("\n        "+e._s(e.$t("change_number"))+"\n      ")])])])],1)}),[],!1,null,null,null);t.a=component.exports},1557:function(e,t,n){"use strict";n.r(t);n(17);var o=n(1),r=(n(32),n(27),n(3),n(2),n(41),n(48),n(100)),l=n(1145),c=n(1201),m={name:"pages-profile-settings",mixins:[r.a],layout:"garageLayout",middleware:["auth_general",function(e){var t=e.$auth,n=e.redirect;if(t.user.parent_id)return n("/garage-services")}],components:{ChangeEmail:l.a,ChangePhone:c.a},nuxtI18n:{paths:{az:"/profil/parametrler-old"}},head:function(){return this.$headMeta({title:this.$t("user_information_edit")})},asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$auth,o=e.app,t.next=3,n.fetchUser();case 3:return t.abrupt("return",{form:{old:"",password:"",password_confirmation:"",name:n.user.name||"",lastname:n.user.lastname||"",gender:n.user.gender||0,birthday:o.$moment(n.user.birthday||null).format("DD.MM.YYYY"),avatar:null}});case 4:case"end":return t.stop()}}),t)})))()},computed:{crumbs:function(){return[{name:this.$t("user_information"),route:"/profile"},{name:this.$t("user_information_edit")}]},getGenderOptions:function(){return[{key:0,name:this.$t("not_selected")},{key:1,name:this.$t("male")},{key:2,name:this.$t("female")}]}},methods:{escapeDate:function(e){return null!==e&&""!==e&&"Invalid date"!==e?this.$moment(e,"DD.MM.YYYY").format("DD-MM-YYYY"):null},submit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new FormData,o=["old","password","password_confirmation"],t.t0=regeneratorRuntime.keys(e.form);case 3:if((t.t1=t.t0()).done){t.next=25;break}if(r=t.t1.value,l=e.form[r],"birthday"!==r){t.next=10;break}if(l=e.escapeDate(l)){t.next=10;break}return t.abrupt("continue",3);case 10:if("avatar"!==r){t.next=20;break}if(!l){t.next=17;break}return t.next=14,null===(c=l)||void 0===c?void 0:c.promisedBlob("image/jpeg",.8);case 14:l=t.sent,t.next=18;break;case 17:return t.abrupt("continue",3);case 18:t.next=22;break;case 20:if(!o.includes(r)||o.filter((function(t){return!!e.form[t]})).length){t.next=22;break}return t.abrupt("continue",3);case 22:n.append(r,l),t.next=3;break;case 25:e.$axios.$post("/profile/change_info",n).then((function(t){e.$toasted.success(e.$t("saved_changes")),e.form.old="",e.form.password="",e.form.password_confirmation="",e.$auth.fetchUser(),e.$router.push(e.$localePath("/profile/settings"))}));case 26:case"end":return t.stop()}}),t)})))()}}},h=n(12),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pages-profile-settings"},[t("div",{staticClass:"container"},[t("portal",{attrs:{to:"breadcrumbs"}},[t("breadcrumbs",{attrs:{crumbs:e.crumbs}})],1),e._v(" "),t(e.isMobileBreakpoint?"mobile-screen":"div",{tag:"component",attrs:{"bar-title":e.$t("user_information_edit"),"height-auto":""},on:{back:function(t){e.$router.push(e.pageRef||e.$localePath("/profile/settings"))}}},[t("div",{staticClass:"card profile-settings-card"},[t("div",{staticClass:"avatar_edit"},[t("form-image",{attrs:{"initial-image":e.getUserAvatar,croppable:"",width:100,height:100},model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}}),e._v(" "),t("p",{staticClass:"text-center"},[e._v("100x100px")])],1),e._v(" "),t("div",{staticClass:"row profile_edit"},[t("div",{staticClass:"col-lg-4 mb-3 mb-lg-3"},[t("form-text-input",{attrs:{maxlength:30,placeholder:e.$t("name")},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("div",{staticClass:"col-lg-4 mb-3 mb-lg-3"},[t("form-text-input",{attrs:{placeholder:e.$t("birthday"),"input-date":""},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1),e._v(" "),t("div",{staticClass:"col-lg-4 mb-3 mb-lg-3"},[t("form-buttons",{attrs:{options:e.getGenderOptions,"group-by":3,"btn-class":"primary-outline"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}})],1),e._v(" "),t("div",{staticClass:"col-lg-4 mb-3 mb-lg-3"},[t("change-email",{attrs:{placeholder:e.$t("email")}})],1),e._v(" "),t("div",{staticClass:"col-lg-4 mb-3 mb-lg-3"},[t("change-phone",{attrs:{placeholder:e.$t("contact_number")}})],1),e._v(" "),t("div",{staticClass:"full-width"}),e._v(" "),t("div",{staticClass:"col-lg-2 offset-lg-10"},[t("button",{staticClass:"btn btn--green full-width",on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))])])])])])],1)])}),[],!1,null,null,null);t.default=component.exports}}]);